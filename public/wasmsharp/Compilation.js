function get(json) {
    return JSON.parse(json);
}
export class Compilation {
    compilationId;
    wasmHost;
    constructor(compilationId, wasmHost) {
        this.compilationId = compilationId;
        this.wasmHost = wasmHost;
    }
    static create(code, interop) {
        const compilationId = interop.CreateNewCompilation(code);
        return new Compilation(compilationId, interop);
    }
    recompileAsync(code) {
        return Promise.resolve(this.wasmHost.Recompile(this.compilationId, code));
    }
    async getDiagnosticsAsync() {
        const diagnostics = await this.wasmHost.GetDiagnosticsAsync(this.compilationId);
        return get(diagnostics);
    }
    async getCompletions(caretPosition, filterText) {
        const completions = await this.wasmHost.GetCompletionsAsync(this.compilationId, caretPosition, filterText);
        return get(completions);
    }
    async shouldTriggerCompletionsAsync(caretPosition, character, operation) {
        if (character || operation) {
            if (character && operation) {
                return this.wasmHost.ShouldTriggerCompletionsAsync(this.compilationId, caretPosition, character, operation);
            }
            throw new TypeError("Expected both character and operation to be provided or for neither to be provided.");
        }
        return this.wasmHost.ShouldTriggerCompletionsAsync(this.compilationId, caretPosition);
    }
    async run() {
        const runResult = await this.wasmHost.RunAsync(this.compilationId);
        return get(runResult);
    }
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiQ29tcGlsYXRpb24uanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi9Db21waWxhdGlvbi50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFHQSxTQUFTLEdBQUcsQ0FBSSxJQUFTO0lBQ3ZCLE9BQU8sSUFBSSxDQUFDLEtBQUssQ0FBQyxJQUFJLENBQU0sQ0FBQztBQUMvQixDQUFDO0FBRUQsTUFBTSxPQUFPLFdBQVc7SUFDTTtJQUFzQztJQUFsRSxZQUE0QixhQUE0QixFQUFVLFFBQTRCO1FBQWxFLGtCQUFhLEdBQWIsYUFBYSxDQUFlO1FBQVUsYUFBUSxHQUFSLFFBQVEsQ0FBb0I7SUFBRyxDQUFDO0lBRWxHLE1BQU0sQ0FBQyxNQUFNLENBQUMsSUFBWSxFQUFFLE9BQTJCO1FBQ3JELE1BQU0sYUFBYSxHQUFHLE9BQVEsQ0FBQyxvQkFBb0IsQ0FBQyxJQUFJLENBQUMsQ0FBQztRQUMxRCxPQUFPLElBQUksV0FBVyxDQUFDLGFBQWEsRUFBRSxPQUFPLENBQUMsQ0FBQztJQUNqRCxDQUFDO0lBRUQsY0FBYyxDQUFDLElBQVk7UUFDekIsT0FBTyxPQUFPLENBQUMsT0FBTyxDQUFDLElBQUksQ0FBQyxRQUFRLENBQUMsU0FBUyxDQUFDLElBQUksQ0FBQyxhQUFhLEVBQUUsSUFBSSxDQUFDLENBQUMsQ0FBQztJQUM1RSxDQUFDO0lBRUQsS0FBSyxDQUFDLG1CQUFtQjtRQUN2QixNQUFNLFdBQVcsR0FBRyxNQUFNLElBQUksQ0FBQyxRQUFRLENBQUMsbUJBQW1CLENBQUMsSUFBSSxDQUFDLGFBQWEsQ0FBQyxDQUFDO1FBQ2hGLE9BQU8sR0FBRyxDQUFlLFdBQVcsQ0FBQyxDQUFDO0lBQ3hDLENBQUM7SUFFRCxLQUFLLENBQUMsY0FBYyxDQUFDLGFBQXFCLEVBQUUsVUFBbUI7UUFDN0QsTUFBTSxXQUFXLEdBQUcsTUFBTSxJQUFJLENBQUMsUUFBUSxDQUFDLG1CQUFtQixDQUFDLElBQUksQ0FBQyxhQUFhLEVBQUUsYUFBYSxFQUFFLFVBQVUsQ0FBQyxDQUFDO1FBQzNHLE9BQU8sR0FBRyxDQUFtQixXQUFXLENBQUMsQ0FBQztJQUM1QyxDQUFDO0lBUUQsS0FBSyxDQUFDLDZCQUE2QixDQUNqQyxhQUFxQixFQUNyQixTQUFrQixFQUNsQixTQUE4QjtRQUU5QixJQUFJLFNBQVMsSUFBSSxTQUFTLEVBQUUsQ0FBQztZQUMzQixJQUFJLFNBQVMsSUFBSSxTQUFTLEVBQUUsQ0FBQztnQkFDM0IsT0FBTyxJQUFJLENBQUMsUUFBUSxDQUFDLDZCQUE2QixDQUFDLElBQUksQ0FBQyxhQUFhLEVBQUUsYUFBYSxFQUFFLFNBQVMsRUFBRSxTQUFTLENBQUMsQ0FBQztZQUM5RyxDQUFDO1lBQ0QsTUFBTSxJQUFJLFNBQVMsQ0FBQyxxRkFBcUYsQ0FBQyxDQUFDO1FBQzdHLENBQUM7UUFDRCxPQUFPLElBQUksQ0FBQyxRQUFRLENBQUMsNkJBQTZCLENBQUMsSUFBSSxDQUFDLGFBQWEsRUFBRSxhQUFhLENBQUMsQ0FBQztJQUN4RixDQUFDO0lBRUQsS0FBSyxDQUFDLEdBQUc7UUFDUCxNQUFNLFNBQVMsR0FBRyxNQUFNLElBQUksQ0FBQyxRQUFRLENBQUMsUUFBUSxDQUFDLElBQUksQ0FBQyxhQUFhLENBQUMsQ0FBQztRQUNuRSxPQUFPLEdBQUcsQ0FBWSxTQUFTLENBQUMsQ0FBQztJQUNuQyxDQUFDO0NBQ0YiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgdHlwZSB7IERpYWdub3N0aWMsIENvbXBsZXRpb25JdGVtLCBSdW5SZXN1bHQgfSBmcm9tIFwiLi9XYXNtQ29tcGlsZXIuanNcIjtcclxuaW1wb3J0IHR5cGUgeyBDaGFyYWN0ZXJPcGVyYXRpb24sIENvbXBpbGF0aW9uSWQsIENvbXBpbGF0aW9uSW50ZXJvcCB9IGZyb20gXCIuL0NvbXBpbGF0aW9uSW50ZXJvcC5qc1wiO1xyXG5cclxuZnVuY3Rpb24gZ2V0PFQ+KGpzb246IGFueSk6IFQge1xyXG4gIHJldHVybiBKU09OLnBhcnNlKGpzb24pIGFzIFQ7XHJcbn1cclxuXHJcbmV4cG9ydCBjbGFzcyBDb21waWxhdGlvbiB7XHJcbiAgcHJpdmF0ZSBjb25zdHJ1Y3Rvcihwcml2YXRlIGNvbXBpbGF0aW9uSWQ6IENvbXBpbGF0aW9uSWQsIHByaXZhdGUgd2FzbUhvc3Q6IENvbXBpbGF0aW9uSW50ZXJvcCkge31cclxuXHJcbiAgc3RhdGljIGNyZWF0ZShjb2RlOiBzdHJpbmcsIGludGVyb3A6IENvbXBpbGF0aW9uSW50ZXJvcCk6IENvbXBpbGF0aW9uIHtcclxuICAgIGNvbnN0IGNvbXBpbGF0aW9uSWQgPSBpbnRlcm9wIS5DcmVhdGVOZXdDb21waWxhdGlvbihjb2RlKTtcclxuICAgIHJldHVybiBuZXcgQ29tcGlsYXRpb24oY29tcGlsYXRpb25JZCwgaW50ZXJvcCk7XHJcbiAgfVxyXG5cclxuICByZWNvbXBpbGVBc3luYyhjb2RlOiBzdHJpbmcpIHtcclxuICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUodGhpcy53YXNtSG9zdC5SZWNvbXBpbGUodGhpcy5jb21waWxhdGlvbklkLCBjb2RlKSk7XHJcbiAgfVxyXG5cclxuICBhc3luYyBnZXREaWFnbm9zdGljc0FzeW5jKCkge1xyXG4gICAgY29uc3QgZGlhZ25vc3RpY3MgPSBhd2FpdCB0aGlzLndhc21Ib3N0LkdldERpYWdub3N0aWNzQXN5bmModGhpcy5jb21waWxhdGlvbklkKTtcclxuICAgIHJldHVybiBnZXQ8RGlhZ25vc3RpY1tdPihkaWFnbm9zdGljcyk7XHJcbiAgfVxyXG5cclxuICBhc3luYyBnZXRDb21wbGV0aW9ucyhjYXJldFBvc2l0aW9uOiBudW1iZXIsIGZpbHRlclRleHQ/OiBzdHJpbmcpIHtcclxuICAgIGNvbnN0IGNvbXBsZXRpb25zID0gYXdhaXQgdGhpcy53YXNtSG9zdC5HZXRDb21wbGV0aW9uc0FzeW5jKHRoaXMuY29tcGlsYXRpb25JZCwgY2FyZXRQb3NpdGlvbiwgZmlsdGVyVGV4dCk7XHJcbiAgICByZXR1cm4gZ2V0PENvbXBsZXRpb25JdGVtW10+KGNvbXBsZXRpb25zKTtcclxuICB9XHJcblxyXG4gIHNob3VsZFRyaWdnZXJDb21wbGV0aW9uc0FzeW5jKGNhcmV0UG9zaXRpb246IG51bWJlcik6IFByb21pc2U8Ym9vbGVhbj47XHJcbiAgc2hvdWxkVHJpZ2dlckNvbXBsZXRpb25zQXN5bmMoXHJcbiAgICBjYXJldFBvc2l0aW9uOiBudW1iZXIsXHJcbiAgICBjaGFyYWN0ZXI6IHN0cmluZyxcclxuICAgIG9wZXJhdGlvbjogQ2hhcmFjdGVyT3BlcmF0aW9uXHJcbiAgKTogUHJvbWlzZTxib29sZWFuPjtcclxuICBhc3luYyBzaG91bGRUcmlnZ2VyQ29tcGxldGlvbnNBc3luYyhcclxuICAgIGNhcmV0UG9zaXRpb246IG51bWJlcixcclxuICAgIGNoYXJhY3Rlcj86IHN0cmluZyxcclxuICAgIG9wZXJhdGlvbj86IENoYXJhY3Rlck9wZXJhdGlvblxyXG4gICk6IFByb21pc2U8Ym9vbGVhbj4ge1xyXG4gICAgaWYgKGNoYXJhY3RlciB8fCBvcGVyYXRpb24pIHtcclxuICAgICAgaWYgKGNoYXJhY3RlciAmJiBvcGVyYXRpb24pIHtcclxuICAgICAgICByZXR1cm4gdGhpcy53YXNtSG9zdC5TaG91bGRUcmlnZ2VyQ29tcGxldGlvbnNBc3luYyh0aGlzLmNvbXBpbGF0aW9uSWQsIGNhcmV0UG9zaXRpb24sIGNoYXJhY3Rlciwgb3BlcmF0aW9uKTtcclxuICAgICAgfVxyXG4gICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKFwiRXhwZWN0ZWQgYm90aCBjaGFyYWN0ZXIgYW5kIG9wZXJhdGlvbiB0byBiZSBwcm92aWRlZCBvciBmb3IgbmVpdGhlciB0byBiZSBwcm92aWRlZC5cIik7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gdGhpcy53YXNtSG9zdC5TaG91bGRUcmlnZ2VyQ29tcGxldGlvbnNBc3luYyh0aGlzLmNvbXBpbGF0aW9uSWQsIGNhcmV0UG9zaXRpb24pO1xyXG4gIH1cclxuXHJcbiAgYXN5bmMgcnVuKCkge1xyXG4gICAgY29uc3QgcnVuUmVzdWx0ID0gYXdhaXQgdGhpcy53YXNtSG9zdC5SdW5Bc3luYyh0aGlzLmNvbXBpbGF0aW9uSWQpO1xyXG4gICAgcmV0dXJuIGdldDxSdW5SZXN1bHQ+KHJ1blJlc3VsdCk7XHJcbiAgfVxyXG59XHJcbiJdfQ==